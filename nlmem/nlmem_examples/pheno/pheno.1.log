1                                                          The SAS System                             14:27 Friday, October 25, 2002

NOTE: Copyright (c) 1999 by SAS Institute Inc., Cary, NC, USA. 
NOTE: SAS (r) Proprietary Software Version 8 (TS M0)
      Licensed to UNIVERSITY OF MICHIGAN, Site 0009403007.
NOTE: This session is executing on the SunOS 5.6 platform.




This message is contained in the SAS news file, and is presented upon
initialization.  Edit the files "news" in the "misc/base" directory to
display site-specific news and information in the program log.
The command line option "-nonews" will prevent this display.



NOTE: SAS initialization used:
      real time           0.06 seconds
      cpu time            0.05 seconds
      

NOTE: AUTOEXEC processing beginning; file is /u11/sas800/autoexec.sas.


NOTE: AUTOEXEC processing completed.

1          /*----------------------------------------------------------------*/
2          /*--                                                            --*/
3          /*-- Title:    Examples with phenobarbital data                 --*/
4          /*-- Filename: pheno.1.sas                                      --*/
5          /*-- Date:     April 4, 2000                                    --*/
6          /*--                                                            --*/
7          /*-- Ref:                                                       --*/
8          /*--  1.Grasela, T.H., Jr. and Donn, SM                         --*/
9          /*--    Neonatal population pharmacokinetics for                --*/
10         /*--    phenobarbital derived from routine clinical data        --*/
11         /*--    Dev. Pharmacol. Ther. 8(1985), 374-383                  --*/
12         /*--                                                            --*/
13         /*--  2.Littel, R.C., Miliken, G.A., Stroup, W.A., Wolfinger R.D.-*/
14         /*--    SAS System for Mixed Models                             --*/
15         /*--    SAS Institute, 1996                                     --*/
16         /*--                                                            --*/
17         /*----------------------------------------------------------------*/
18         
19         libname lib '.';
NOTE: Libref LIB was successfully assigned as follows: 
      Engine:        V8 
      Physical Name: /u11/HTML/USERS/pub/nlmem/nlmem_examples/pheno
20         
21         %let path=../..;
22         filename pheno_dt "&path/datasets/pheno_dt.sas";
23         filename nlinmix  "&path/nlmm800.sas";
24         filename nlmem    "&path/nlmem.sas";
25         %include pheno_dt;

NOTE: The data set WORK.PHENO has 744 observations and 8 variables.
NOTE: DATA statement used:
      real time           0.03 seconds
      cpu time            0.04 seconds
      

789        %include  nlinmix / nosource;
2027       
2028       
2029       /* Example 1. Numerical derivatives   */
2030       
2031       Title " Pheno data. Example 1. Numerical  derivatives.";
2032       
2033       %macro usernlin;
2034        *print _nobs;
2035         optn= _nobs ||{5};
2036         tc =j(1,13,.);
2037         tc[1]=2;              /* Termination criterion: # iterations */
2038         call nlplm(rc,_bnlin,"_objf",_b,optn) jac="_dobjf" tc=tc;
2039         print _bnlin;
2040       %mend usernlin;
2041       
2042       %macro useriml;
2043         %let next    =  indiv;
2044         %let imlnlin =  usernlin;
2045         %let xvar    =  weight apgarlow;
2046       %mend  useriml;
2047       
2048       %nlinmix(data=pheno,
2049                stmts   =  %str(class indiv;
2050                model pseudo_conc = d_beta1 d_beta2 d_beta3
2051                                      / noint notest solution cl;
2052                random d_u1 d_u2 / subject=indiv solution cl;
2053                weight _weight_;
2054                ods output Iterhistory=iter;
2055                             ),
2056                globvar = predv,
2057       
2058                model   = %str(
2059                     clear=_b[1]*weight*exp(_u[1]);
2060                     vol  =_b[2]*weight*(1+_b[3]*apgarlow)*exp(_u[2]);
2061                     predv=j(_ni,1,0);
2062                     predv[1] = dose[1]/vol;
2063                     do j =2 to _ni;
2                                                    The SAS System                        14:27 Friday, October 25, 2002

2064                       eterm=exp(-(time[j]-time[j-1])*clear/vol);
2065                       predv[j] =dose[j]/vol + predv[j-1]*eterm;
2066                     end;
2067                     ),
2068       
2069               weight  =  %str(_weight_=1/(predv#predv);),
2070               parms   =  %str(beta1=.01 beta2=1 beta3=.1),
2071               expand  =  zero,
2072               imlfun  =  useriml,
2073               nlmem   =  nlmem / nosource
2074       );

                          The NLINMIX Macro

           Data Set                     : pheno
           Response                     : conc
           Fixed-Effect Parameters      : beta1 beta2 beta3
           Random-Effect Parameters     : u1 u2
           Expansion Point              : zero


ERROR: LEVMAR Optimization cannot be completed.ERROR: LEVMAR Optimization cannot be completed.ERROR: LEVMAR Optimization cannot be completed.
ERROR: LEVMAR needs more than 2 iterations or 500 function calls.ERROR: LEVMAR needs more than 2 iterations or 500 function calls.ERROR: LEVMAR needs more than 2 iterations or 500 function calls.
Iteratively calling PROC MIXED.
   PROC MIXED call 0
   
iteration = 0
convergence criterion = .
beta1=0.0050084222 beta2=1.1276025383 beta3=0.0757246884 COVP1=0.0580397489 COVP2=0.0366980099 COVP3=0.0141634096
   PROC MIXED call 1
   
iteration = 1
convergence criterion = 0.0262567777
beta1=0.0046474414 beta2=0.9404392509 beta3=0.1541137592 COVP1=0.0440453603 COVP2=0.0269842781 COVP3=0.010271163
   PROC MIXED call 2
   
iteration = 2
convergence criterion = 0.0015955214
beta1=0.0046555793 beta2=0.9666960286 beta3=0.1466821731 COVP1=0.0456408816 COVP2=0.0282426421 COVP3=0.0107657526
   PROC MIXED call 3
   
iteration = 3
convergence criterion = 0.0000321307
beta1=0.0046538566 beta2=0.9672582073 beta3=0.1471558263 COVP1=0.0456678501 COVP2=0.0282715159 COVP3=0.0107769269
   PROC MIXED call 4
   
iteration = 4
convergence criterion = 2.2058017E-7
beta1=0.0046538752 beta2=0.9672522877 beta3=0.1471879569 COVP1=0.0456677834 COVP2=0.0282714746 COVP3=0.0107769112
   PROC MIXED call 5
   
iteration = 5
convergence criterion = 6.7199334E-9
beta1=0.0046538758 beta2=0.9672523185 beta3=0.1471881775 COVP1=0.0456677902 COVP2=0.0282714788 COVP3=0.0107769128
NLINMIX convergence criteria met.
NOTE: IML Ready
NOTE: Module _MODEL defined.
NOTE: Module _WEIGHT_ defined.
NOTE: Module _DERIVS defined.
NOTE: Module _PSEUDODER defined.
NOTE: Module _SUBJECT defined.
NOTE: New storage library = WORK._NLMEM
NOTE: The data set WORK._NLINMX2 has 744 observations and 9 variables.
NOTE: Exiting IML.
NOTE: Storage library WORK._NLMEM closed.
NOTE: 13 workspace compresses.
NOTE: PROCEDURE IML used:
      real time           1.88 seconds
      cpu time            1.88 seconds
      


NOTE: There were 744 observations read from the dataset WORK._NLINMIX.
NOTE: There were 744 observations read from the dataset WORK._NLINMX2.
NOTE: The data set WORK._NLINMIX has 744 observations and 23 variables.
NOTE: DATA statement used:
      real time           0.02 seconds
      cpu time            0.02 seconds
      

   PROC MIXED call 6

NOTE: 589 observations are not included because of missing values.
NOTE: Convergence criteria met.
NOTE: The data set WORK._SOLNR has 118 observations and 10 variables.
NOTE: The data set WORK._COV has 3 observations and 3 variables.
NOTE: The data set WORK._SOLN has 3 observations and 9 variables.
NOTE: The data set WORK._FIT has 4 observations and 2 variables.
NOTE: The data set WORK.ITER has 1 observations and 4 variables.
NOTE: There were 744 observations read from the dataset WORK._NLINMIX.
NOTE: There were 3 observations read from the dataset WORK._COVSAVE.
NOTE: The PROCEDURE MIXED printed pages 1-3.
NOTE: PROCEDURE MIXED used:
      real time           0.17 seconds
      cpu time            0.17 seconds
      


3                                                    The SAS System                        14:27 Friday, October 25, 2002

NOTE: Numeric values have been converted to character values at the places given by: (Line):(Column).
      2692:51   
NOTE: There were 4 observations read from the dataset WORK._FIT.
NOTE: DATA statement used:
      real time           0.00 seconds
      cpu time            0.00 seconds
      

2693       

ERROR: Errors printed on page 2.ERROR: Errors printed on page 2.ERROR: Errors printed on page 2.

NOTE: SAS Institute Inc., SAS Campus Drive, Cary, NC USA 27513-2414
NOTE: The SAS System used:
      real time           26.19 seconds
      cpu time            25.68 seconds
      
