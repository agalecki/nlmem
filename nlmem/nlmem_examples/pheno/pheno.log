1                                                          The SAS System                             14:35 Friday, October 25, 2002

NOTE: Copyright (c) 1999 by SAS Institute Inc., Cary, NC, USA. 
NOTE: SAS (r) Proprietary Software Version 8 (TS M0)
      Licensed to UNIVERSITY OF MICHIGAN, Site 0009403007.
NOTE: This session is executing on the SunOS 5.6 platform.




This message is contained in the SAS news file, and is presented upon
initialization.  Edit the files "news" in the "misc/base" directory to
display site-specific news and information in the program log.
The command line option "-nonews" will prevent this display.



NOTE: SAS initialization used:
      real time           0.05 seconds
      cpu time            0.05 seconds
      

NOTE: AUTOEXEC processing beginning; file is /u11/sas800/autoexec.sas.


NOTE: AUTOEXEC processing completed.

1          /*----------------------------------------------------------------*/
2          /*--                                                            --*/
3          /*-- Title:    Examples with phenobarbital data                 --*/
4          /*-- Filename: pheno.sas                                        --*/
5          /*--           Invokes pheno_dt.sas                             --*/
6          /*-- Date:     April 4, 2000                                    --*/
7          /*--                                                            --*/
8          /*-- Ref:                                                       --*/
9          /*--  1.Grasela, T.H., Jr. and Donn, SM                         --*/
10         /*--    Neonatal population pharmacokinetics for                --*/
11         /*--    phenobarbital derived from routine clinical data        --*/
12         /*--    Dev. Pharmacol. Ther. 8(1985), 374-383                  --*/
13         /*--                                                            --*/
14         /*--  2.Littel, R.C., Miliken, G.A., Stroup, W.A., Wolfinger R.D.-*/
15         /*--    SAS System for Mixed Models                             --*/
16         /*--    SAS Institute, 1996                                     --*/
17         /*--                                                            --*/
18         /*----------------------------------------------------------------*/
19         
20         libname lib '.';
NOTE: Libref LIB was successfully assigned as follows: 
      Engine:        V8 
      Physical Name: /u11/HTML/USERS/pub/nlmem/nlmem_examples/pheno
21         
22         
23         %let path=../..;
24         filename pheno_dt "&path/datasets/pheno_dt.sas";
25         filename nlinmix  "&path/nlmm800.sas";
26         filename nlmem    "&path/nlmem.sas";
27         %include pheno_dt;

NOTE: The data set WORK.PHENO has 744 observations and 8 variables.
NOTE: DATA statement used:
      real time           0.03 seconds
      cpu time            0.04 seconds
      

791        %include  nlinmix / nosource;
2029       
2030       /* Example 1. Numerical derivatives   */
2031       
2032       Title "Pheno data. Example 1. Numerical  derivatives.";
2033       
2034       %macro usernlin;
2035        *print _nobs;
2036         optn= _nobs ||{5};
2037         tc =j(1,13,.);
2038         tc[1]=2;              /* Termination criterion: # iterations */
2039         call nlplm(rc,_bnlin,"_objf",_b,optn) jac="_dobjf" tc=tc;
2040         print _bnlin;
2041       %mend usernlin;
2042       
2043       %macro useriml;
2044         %let imlnlin  =  usernlin;
2045         %let savevar  = clear vol eterm t_lag;
2046       %mend  useriml;
2047       
2048       %nlinmix(data=pheno(drop=tlag),
2049                stmts   =  %str(class indiv;
2050                model pseudo_conc = d_beta1 d_beta2 d_beta3
2051                                      / noint notest solution cl;
2052                random d_u1 d_u2 / subject=indiv solution cl;
2053                weight _weight_;
2054                ods output Iterhistory=iter;
2055                             ),
2056                globvar = predv  _mcall predt_lag  t_lag predt
2057                          clear vol eterm,
2058                modinit = %str (
2059                     if (newsub=1) then do;
2060                             predt_lag=j(1,12,0);
2061                             t_lag =0;
2062                         end;
2063                        ),
2                                                    The SAS System                        14:35 Friday, October 25, 2002

2064       
2065                model   = %str(
2066                     predv_lag  =  predt_lag[,_mcall];
2067                     clear      =  _b[1]*weight*exp(_u[1]);
2068                     vol        =  _b[2]*weight*(1+_b[3]*apgarlow)*exp(_u[2]);
2069                     eterm      =  exp(-(time-t_lag)*clear/vol);
2070                     predv      =  dose/vol + predv_lag*eterm;
2071                     ),
2072       
2073                weight  =  %str( _weight_=1/predv**2;),
2074                retain  =  %str(predt_lag  = predt;
2075                               t_lag     = time;),
2076       
2077                parms   =  %str(beta1=.01 beta2=1 beta3=.1),
2078                expand  =  zero,
2079                options =  debug,
2080                imlfun  =  useriml,
2081                nlmem   =  nlmem / nosource
2082       );
model =                predv_lag  =  predt_lag[,_mcall];               clear      =  _b[1]*weight*exp(_u[1]);            
   vol        =  _b[2]*weight*(1+_b[3]*apgarlow)*exp(_u[2]);               eterm      =  exp(-(time-t_lag)*clear/vol);   
            predv      =  dose/vol + predv_lag*eterm;               
derivatives =
fixed = beta1 beta2 beta3
d_fixed = d_beta1 d_beta2 d_beta3
random = u1 u2
d_random = d_u1 d_u2
options =DEBUG
expand  =zero
expandu =ZERO
expandn =0 0
subject  =
next     = 1
imlnlin  = usernlin
imlnlinw = usernlin default_objf default_initobjf
dtmplt   =
dbtmplt  =
dutmplt  =
next    = 1
read    = _readn
subject =
xvar    = _one
tvar    = apgarlow conc dose indiv newsub time weight

                          The NLINMIX Macro

           Data Set                     : pheno(drop=tlag)
           Response                     : conc
           Fixed-Effect Parameters      : beta1 beta2 beta3
           Random-Effect Parameters     : u1 u2
           Expansion Point              : zero


ERROR: LEVMAR Optimization cannot be completed.ERROR: LEVMAR Optimization cannot be completed.ERROR: LEVMAR Optimization cannot be completed.
ERROR: LEVMAR needs more than 2 iterations or 500 function calls.ERROR: LEVMAR needs more than 2 iterations or 500 function calls.ERROR: LEVMAR needs more than 2 iterations or 500 function calls.
Iteratively calling PROC MIXED.
   PROC MIXED call 0
   
iteration = 0
convergence criterion = .
beta1=0.0050084222 beta2=1.1276025383 beta3=0.0757246884 COVP1=0.0580397489 COVP2=0.0366980099 COVP3=0.0141634096
   PROC MIXED call 1
   
iteration = 1
convergence criterion = 0.0262567777
beta1=0.0046474414 beta2=0.9404392509 beta3=0.1541137592 COVP1=0.0440453603 COVP2=0.0269842781 COVP3=0.010271163
   PROC MIXED call 2
   
iteration = 2
convergence criterion = 0.0015955214
beta1=0.0046555793 beta2=0.9666960286 beta3=0.1466821731 COVP1=0.0456408816 COVP2=0.0282426421 COVP3=0.0107657526
   PROC MIXED call 3
   
iteration = 3
convergence criterion = 0.0000321307
beta1=0.0046538566 beta2=0.9672582073 beta3=0.1471558263 COVP1=0.0456678501 COVP2=0.0282715159 COVP3=0.0107769269
   PROC MIXED call 4
   
iteration = 4
convergence criterion = 2.2058017E-7
beta1=0.0046538752 beta2=0.9672522877 beta3=0.1471879569 COVP1=0.0456677834 COVP2=0.0282714746 COVP3=0.0107769112
   PROC MIXED call 5
   
iteration = 5
convergence criterion = 6.7199334E-9
beta1=0.0046538758 beta2=0.9672523185 beta3=0.1471881775 COVP1=0.0456677902 COVP2=0.0282714788 COVP3=0.0107769128
NLINMIX convergence criteria met.
NOTE: IML Ready
NOTE: Module _MODEL defined.
NOTE: Module _WEIGHT_ defined.
NOTE: Module _DERIVS defined.
NOTE: Module _RETAIN defined.
NOTE: Module _SAVEVAR defined.
NOTE: Module _PSEUDODER defined.
NOTE: Module _SUBJECT defined.
NOTE: New storage library = WORK._NLMEM
NOTE: The data set WORK._NLINMX2 has 744 observations and 13 variables.
NOTE: Exiting IML.
3                                                    The SAS System                        14:35 Friday, October 25, 2002

NOTE: Storage library WORK._NLMEM closed.
NOTE: 31 workspace compresses.
NOTE: PROCEDURE IML used:
      real time           4.24 seconds
      cpu time            4.23 seconds
      


NOTE: There were 744 observations read from the dataset WORK._NLINMIX.
NOTE: There were 744 observations read from the dataset WORK._NLINMX2.
NOTE: The data set WORK._NLINMIX has 744 observations and 26 variables.
NOTE: DATA statement used:
      real time           0.02 seconds
      cpu time            0.03 seconds
      


NOTE: There were 744 observations read from the dataset WORK._NLINMIX.
NOTE: The PROCEDURE MEANS printed page 3.
NOTE: PROCEDURE MEANS used:
      real time           0.01 seconds
      cpu time            0.01 seconds
      


NOTE: There were 744 observations read from the dataset WORK._NLINMIX.
NOTE: The data set WORK.DEBUG has 744 observations and 29 variables.
NOTE: DATA statement used:
      real time           0.01 seconds
      cpu time            0.02 seconds
      


NOTE: There were 30 observations read from the dataset WORK.DEBUG.
NOTE: The PROCEDURE PRINT printed page 4.
NOTE: PROCEDURE PRINT used:
      real time           0.01 seconds
      cpu time            0.01 seconds
      


NOTE: Appending WORK.DEBUG to WORK.ALLDEBUG.
NOTE: There were 744 observations read from the dataset WORK.DEBUG.
NOTE: 744 observations added.
NOTE: The data set WORK.ALLDEBUG has 6696 observations and 29 variables.
NOTE: PROCEDURE APPEND used:
      real time           0.01 seconds
      cpu time            0.02 seconds
      

   PROC MIXED call 6

NOTE: 589 observations are not included because of missing values.
NOTE: Convergence criteria met.
NOTE: The data set WORK._SOLNR has 118 observations and 10 variables.
NOTE: The data set WORK._COV has 3 observations and 3 variables.
NOTE: The data set WORK._SOLN has 3 observations and 9 variables.
NOTE: The data set WORK._FIT has 4 observations and 2 variables.
NOTE: The data set WORK.ITER has 1 observations and 4 variables.
NOTE: There were 744 observations read from the dataset WORK._NLINMIX.
NOTE: There were 3 observations read from the dataset WORK._COVSAVE.
NOTE: The PROCEDURE MIXED printed pages 5-7.
NOTE: PROCEDURE MIXED used:
      real time           0.16 seconds
      cpu time            0.17 seconds
      


NOTE: Numeric values have been converted to character values at the places given by: (Line):(Column).
      2700:51   
NOTE: There were 4 observations read from the dataset WORK._FIT.
NOTE: DATA statement used:
      real time           0.00 seconds
      cpu time            0.00 seconds
      

2701       run;
2702       

ERROR: Errors printed on page 2.ERROR: Errors printed on page 2.ERROR: Errors printed on page 2.

NOTE: SAS Institute Inc., SAS Campus Drive, Cary, NC USA 27513-2414
NOTE: The SAS System used:
      real time           56.41 seconds
      cpu time            55.65 seconds
      
