1                                                          The SAS System                             13:41 Friday, October 25, 2002

NOTE: Copyright (c) 1999 by SAS Institute Inc., Cary, NC, USA. 
NOTE: SAS (r) Proprietary Software Version 8 (TS M0)
      Licensed to UNIVERSITY OF MICHIGAN, Site 0009403007.
NOTE: This session is executing on the SunOS 5.6 platform.




This message is contained in the SAS news file, and is presented upon
initialization.  Edit the files "news" in the "misc/base" directory to
display site-specific news and information in the program log.
The command line option "-nonews" will prevent this display.



NOTE: SAS initialization used:
      real time           0.06 seconds
      cpu time            0.07 seconds
      

NOTE: AUTOEXEC processing beginning; file is /u11/sas800/autoexec.sas.


NOTE: AUTOEXEC processing completed.

1          /*----------------------------------------------------------------*/
2          /*--                                                            --*/
3          /*-- Title:    Examples with phenobarbital data                 --*/
4          /*-- Filename: pheno.sas                                        --*/
5          /*--           Invokes pheno_dt.sas                             --*/
6          /*-- Date:     April 4, 2000                                    --*/
7          /*--                                                            --*/
8          /*-- Ref:                                                       --*/
9          /*--  1.Grasela, T.H., Jr. and Donn, SM                         --*/
10         /*--    Neonatal population pharmacokinetics for                --*/
11         /*--    phenobarbital derived from routine clinical data        --*/
12         /*--    Dev. Pharmacol. Ther. 8(1985), 374-383                  --*/
13         /*--                                                            --*/
14         /*--  2.Littel, R.C., Miliken, G.A., Stroup, W.A., Wolfinger R.D.-*/
15         /*--    SAS System for Mixed Models                             --*/
16         /*--    SAS Institute, 1996                                     --*/
17         /*--                                                            --*/
18         /*--   Execution time: ~ 3 mins                                 --*/
19         /*----------------------------------------------------------------*/
20         
21         
22         libname lib '.';
NOTE: Libref LIB was successfully assigned as follows: 
      Engine:        V8 
      Physical Name: /u11/HTML/USERS/pub/nlmem/nlmem_examples/MAINexamples
23         
24         /* nlinmix macro. Choose appropriate version */
25         
26         %let path=../..;
27         filename pheno_dt "&path/datasets/pheno_dt.sas";
28         filename nlinmix  "&path/nlmm800.sas";
29         filename nlmem    "&path/nlmem.sas";
30         
31         %include pheno_dt;

NOTE: The data set WORK.PHENO has 744 observations and 8 variables.
NOTE: DATA statement used:
      real time           0.03 seconds
      cpu time            0.03 seconds
      

795        %include  nlinmix / nosource;
2033       
2034       
2035       /* Example 1. Numerical derivatives   */
2036       
2037       Title " Pheno data. Example 1. Numerical  derivatives.";
2038       
2039       %nlinmix(data=pheno(drop=tlag),
2040                stmts   =  %str(class indiv;
2041                model pseudo_conc = d_beta1 d_beta2 d_beta3
2042                                      / noint notest solution cl;
2043                random d_u1 d_u2 / subject=indiv solution cl;
2044                weight _weight_;
2045                ods output Iterhistory=iter;
2046                               ),
2047                globvar = predv  _mcall predt_lag  t_lag predt,
2048                modinit = %str (
2049                     if (newsub=1) then do;
2050                             predt_lag=j(1,12,0);
2051                             t_lag =0;
2052                         end;
2053                        ),
2054       
2055                model   = %str(
2056                     predv_lag  =  predt_lag[,_mcall];
2057                     clear      =  _b[1]*weight*exp(_u[1]);
2058                     vol        =  _b[2]*weight*(1+_b[3]*apgarlow)*exp(_u[2]);
2059                     eterm      =  exp(-(time-t_lag)*clear/vol);
2060                     predv      =  dose/vol + predv_lag*eterm;
2061                     ),
2062       
2063              weight  =  %str( _weight_=1/predv**2;),
2                                                    The SAS System                        13:41 Friday, October 25, 2002

2064              retain  =  %str(predt_lag  = predt;
2065                               t_lag     = time;),
2066       
2067              parms   =  %str(beta1=.01 beta2=1 beta3=.1),
2068              expand  =  zero,
2069              nlmem   =  nlmem
2070       );

                          The NLINMIX Macro

           Data Set                     : pheno(drop=tlag)
           Response                     : conc
           Fixed-Effect Parameters      : beta1 beta2 beta3
           Random-Effect Parameters     : u1 u2
           Expansion Point              : zero


Iteratively calling PROC MIXED.
   PROC MIXED call 0
   
iteration = 0
convergence criterion = .
beta1=0.0048721859 beta2=0.9470735173 beta3=0.2201068585 COVP1=0.0459573226 COVP2=0.0282343681 COVP3=0.0107086959
   PROC MIXED call 1
   
iteration = 1
convergence criterion = 0.004211453
beta1=0.0046568132 beta2=0.9673567079 beta3=0.1428807592 COVP1=0.045686786 COVP2=0.0282447012 COVP3=0.0107691743
   PROC MIXED call 2
   
iteration = 2
convergence criterion = 0.0000953722
beta1=0.0046537596 beta2=0.9672608964 beta3=0.1470922122 COVP1=0.0456671764 COVP2=0.0282709343 COVP3=0.0107767588
   PROC MIXED call 3
   
iteration = 3
convergence criterion = 6.9181991E-7
beta1=0.0046538739 beta2=0.9672522115 beta3=0.1471875844 COVP1=0.0456678682 COVP2=0.0282713626 COVP3=0.010776922
   PROC MIXED call 4
   
iteration = 4
convergence criterion = 2.0502708E-8
beta1=0.0046538758 beta2=0.9672523179 beta3=0.1471881718 COVP1=0.0456678887 COVP2=0.0282713753 COVP3=0.0107769269
   PROC MIXED call 5
   
iteration = 5
convergence criterion = 1.373822E-10
beta1=0.0046538758 beta2=0.9672523189 beta3=0.1471881737 COVP1=0.0456678888 COVP2=0.0282713754 COVP3=0.0107769269
NLINMIX convergence criteria met.
NOTE: IML Ready
NOTE: Module _MODEL defined.
NOTE: Module _WEIGHT_ defined.
NOTE: Module _DERIVS defined.
NOTE: Module _RETAIN defined.
NOTE: Module _PSEUDODER defined.
NOTE: Module _SUBJECT defined.
NOTE: New storage library = WORK._NLMEM
NOTE: The data set WORK._NLINMX2 has 744 observations and 9 variables.
NOTE: Exiting IML.
NOTE: Storage library WORK._NLMEM closed.
NOTE: 28 workspace compresses.
NOTE: PROCEDURE IML used:
      real time           4.20 seconds
      cpu time            4.00 seconds
      


NOTE: There were 744 observations read from the dataset WORK._NLINMIX.
NOTE: There were 744 observations read from the dataset WORK._NLINMX2.
NOTE: The data set WORK._NLINMIX has 744 observations and 22 variables.
NOTE: DATA statement used:
      real time           0.02 seconds
      cpu time            0.02 seconds
      

   PROC MIXED call 6

NOTE: 589 observations are not included because of missing values.
NOTE: Convergence criteria met.
NOTE: The data set WORK._SOLNR has 118 observations and 10 variables.
NOTE: The data set WORK._COV has 3 observations and 3 variables.
NOTE: The data set WORK._SOLN has 3 observations and 9 variables.
NOTE: The data set WORK._FIT has 4 observations and 2 variables.
NOTE: The data set WORK.ITER has 1 observations and 4 variables.
NOTE: There were 744 observations read from the dataset WORK._NLINMIX.
NOTE: There were 3 observations read from the dataset WORK._COVSAVE.
NOTE: The PROCEDURE MIXED printed pages 1-3.
NOTE: PROCEDURE MIXED used:
      real time           0.17 seconds
      cpu time            0.16 seconds
      


NOTE: Numeric values have been converted to character values at the places given by: (Line):(Column).
      2688:51   
NOTE: There were 4 observations read from the dataset WORK._FIT.
NOTE: DATA statement used:
      real time           0.00 seconds
3                                                    The SAS System                        13:41 Friday, October 25, 2002

      cpu time            0.01 seconds
      

2689       run;
2690       
2691       

NOTE: SAS Institute Inc., SAS Campus Drive, Cary, NC USA 27513-2414
NOTE: The SAS System used:
      real time           3:09.76
      cpu time            3:08.03
      
